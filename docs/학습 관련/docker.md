# Docker, Docker Compose, 다중 컨테이너 프로젝트, Deployment 및 Kubernetes에 대해
## Begin
### Docker란?
 Docker is a container technology : A tool for creating and managing containers
 도커는 컨테이너 기술이다. : 컨테이너를 작성하고 관리하는 도구 이다.

 Container란 무엇인가? 표준화된 소프트웨어 단위 이다.
패키지 코드 종속성을 도커가 실행되는 곳에 가져올 수 있다. 
모든 것이 컨테이너에 있기 때문에 추가 도구 설치가 필요없다!!!

관리를 단순화 하는 도구 이다. 컨테이너를 만드는 것은 표준이다.

### 왜 Docker와 컨테이너 인가?
 소프트웨어 개발에 우리는 왜 독립적인 표준화된 애플리케이션 표준화가 필요한가?
우리는 종종 다른 개발 제품 생산 환경을 가지고 있다. 개발과 제품이 동일한 환경을
가지고 있다면 상당한 이점이 있다.
코드가 항상 정확한 버젼에서 실행된다. 

다른 개봘 환경 팀/회사에서 통일 시킬 수 있다. 

혼자 작업하는 경우. 작업 중인 프로젝트가 많은 경우. 각각 버젼이 다를 경우가 있음
이를 격리 시킬 수 있다.

### 가상머신과 Docker 컨테이너의 차이
가상 머신을 쓴다는 것은 컴퓨터 안에 컴퓨터 이다. 맞지..
1. 가상운영체제에서 발생하는 오버헤드이다. 이러한 머신이 여러개 있는 경우.
    메모리 CPU 하드 드라이브 공간을 낭비하게 된다.
    버츄얼 머신이 점점 더 많아진다면 문제가 된다.
    복제 된다면 운영체자가 계속 중복해서 설치된다!

 - 장점
    1) 구분된 환경
    2) 환경 별로  별도 설정 가능
    3) 환경 설정이 공유 가능하고 재생산 가능하다.
 - 단점 
    1) 중복 되고 버러지는 공간
    2) 성능이 느려지고 부팅 타임이 길다
    3) 원하는 모든 시스템에 그 버츄얼 머신 설정을 해야한다.
*. 프로던션과 버츄얼 머신에 실행 가능하지만.. 

2. 이게 도커를 쓰는 이유이다.
    운영체제위에 올라가지만 머신을 다시 설치하지 않는다
    컨테이너 에뮬레이트를 지원하는 내장 컨테이너를 활용한다.
    도커 엔진이 올라간다.
    그다음 컨테이너가 가동하하게 한다.
    컨테이너에는 라이브러리 의존성 툴과 앱만 들어간다.
    VM 보다 매우 작은 운영체제 레이어가 있지만 훨씬 작다!

구성 파일을 만들고 그것을 공유해서 컨테이너 이미지를 빌드할 수 있다.
이미지를 다른사람과 공유해서 같은 컨테이너에서 시작할 수 있도록 한다.

 - 장점
    1) 로우 임팩티 매우 빠르다 매우 적은 용량
    2) 공유 리빌드 배포가 쉽다.
    3) 캡슈화 되어 있다. 앱과 환경을 공유하지만 그외에는 없다.

 - vm은 속도 느리고 디스크 공간을 더 많이 차지 한다.
 - 공유 리빌드 배포가 가능하지만 까다롭다.
 - 환경을 캡슐화 하지만 앱과 앱을 실행에 필요한 것이 아니라. 
   운영체제를 통채로 캡슐화 한다.

### Docker 설정 - 개요.
macOS의 경우 
요구사항을 충족하면 도커 데스크탑을 설치한다.
요구사항을 미충족하면 도커 툴박스를 설치한다.
windows의 경우
요구사항을 충족하면 도커 데스크탑을 설치한다.
요구사항을 미충족하면 도커 툴박스를 설치한다.
Linux의 경우
도커 엔진을 인스톨한다.

### Docker Tools 개요
Docker Engine이 설치 됐다.
*. Docker를 실행하는 Linux 가상 머신이 셋팅 되었다.
*. 운영체제가 기본적으로 도커를 지원하지 않는다.
Docker Desktop 
*. 이건 도구 일 뿐이다. 
Docker Hub에 대해서 확인하게 된다. 다른 시스템과 사람들에게 공유해주는 
Docker Compose에 대해서 하는 도구 복잡한 컨테이너 또는 다중 컨테이너 프로젝트를
더 쉽게 관리할 수 있다.

### 맞보기
도커 이미지를 생성해야한다.
프로젝트에 Dockerfile을 생성해야 한다. 컨테이너에게 도커를 어떻게 설정하는지
알려야 한다.

Dockerfile
FROM node:14

WORKDIR /app

COPY package.json .

RUN npm install

COPY . .

EXPOSE 3000

CMD ["npm", "start"]

이렇게 하고. 아래와 같이 명령한다.
docker build . 

최종적으로 image 이미지를 제공한다.
 => => writing image sha256:ed34cdc4e5125171acc1fa53970e1c717ae487a407e9bcc5edf77bb202895b8c  

실제로 실행하려는 해당 컨테이너에 해당 포트를 게시(publish)해야 한다.
-p 플래그를 제공하면 
docker run -p 3000:3000 [이미지 id]

docker의 3000번 포트를 서버의 3000번 포트로 연결한다.
컨테이너와 호스트 운영체제 사이에는 디폴트 연결이 없기 때문이다.
포트를 열어줘야 한다!!!

아래는 현재 실행중인 컨테이너를 확인 할 수 있다.
docker ps 

## Docker 이미지 & 컨테이너 : 코어 빌딩
### 이미지 & 컨테이너: 무엇이며, 왜 사용하는가?
- 컨테이너 : 애플리케이션을 실행하는 어떤것을 포함하는 패키지이다.
   - 실행가능한 소프트웨어 단위이다.
- Images : 이미지는 템플릿, 컨테이너의 블루 프린트가 될 것이기 때문이다.
   - 이미지는 실제로 코드와 코드를 실행하는데 필요한 도구를 포함한다.

- 이미지활용 
   - 이미지를 이용해서 여러 컨테이너를 만들 수 있다.
   - 이미지는 모든 설정 명령과 모든 코드가 포함된 공유 가능한 패키지 이다.
   - 컨테이너는 그러한 이미지의 구체적인 실행 인스턴스 이다.

- 이미지 얻기
   - 이미지를 생성하고, 가져오는 두가지 방법이 있다.
      1) 이미 존재하거나 빌트된 이미지를 사용한다.
         - Docker Hub-hub.docker.com : node 이미지를 가져와서 
         docker run node : 도커 허브에서 찾은 이미지를 활용해서 컨테이너를 생성한다.
         - NodeJS는 인터렉티브 모드를 제공하는데 기본적인 노드 명령어인 REPL을 사용할 수 있다.
         - 컨테이너는 기본적으로 주변환경과 격리되어 있고, 실행중인 인터렉티브 쉘이 있어도, 사용자에게 노출되지 않는다.
            *. docker ps -a 
            ps 는 프로세스를 의미하고, -a 는 전체 목록이다.

            docker run -it node 
            도커에게 컨테이너 내부에서 호스팅 머신으로 대화형 세션을 노출시킨다.